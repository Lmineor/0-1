# 简述
本章介绍与区块链密切相关的安全知识，包括Hash算法与摘要、加密算法、数字签名和证书、PKI体系、Merkle树、布隆过滤器、同态加密等。以及如何实现信息安全的核心要素：机密性、完整性、可认证性和不可抵赖性。

# 密码学简史
1945 年 9 月 1 日，Claude Elwood Shannon（克劳德·艾尔伍德·香农）完成了划时代的内部报告《A Mathematical Theory of Cryptography（密码术的一个数学理论）》，1949 年 10 月，该报告以《Communication Theory of Secrecy Systems（保密系统的通信理论）》为题在 Bell System Technical Journal（贝尔系统技术期刊）上正式发表。这篇论文首次将密码学和信息论联系到一起，为对称密码技术提供了数学基础。这也标志着近现代密码学的正式建立

---
# Hash算法与数字摘要
## 定义
Hash（哈希或散列）算法，又常被称为指纹（Fingerprint）或摘要（Digest）算法，可以将任意长度的二进制明文串映射为较短的（通常是固定长度的）二进制串（Hash值），并且不同的明文很难映射为相同的hash值。

例如计算”“Hello World， this is block chain guide”的SHA-256 Hash值
```bash
echo "Hello World， this is block chain guide" | shasum -a 256

1af429b3446508b63400ce6a9cface6bfd3f8566fe014f5f590d540f910a81a9
```

因此对于某个文件，无需查看其内容，只要其SHA-256 Hash计算后结果与上面的结果一致，则该文件内容大概率就是上面的字符串了。
除了快速对比内容外，Hash思想也被用到基于内容的编址或命名算法中。
一个优秀的hash算法，将能满足：
- 正向快速：给定原文和Hash算法，在有限时间和有限资源内能计算得到Hash值。
- 逆向困难：给定（若干）Hash值，在有限时间内无法（基本不可能）逆推出原文；
- 输入敏感：原始输入信息发生任何改变，新产生的Hash值都应该发生很大的变化；
- 碰撞避免：很难找到两段内容不同的铭文，使得它们的Hash值一致（即发生碰撞）。

碰撞避免有时候又被称为“抗碰撞性”，可分为“弱抗碰撞性”和“强抗碰撞性”。给定原文前提下，无法找到与之碰撞的其它原文，则算法具有“弱抗碰撞性”；更一般地，如果无法找到任意两个可碰撞的原文，则称算法具有“强抗碰撞性”。

## 常见算法
Message Digest（MD）系列和Secure Hash Algorithm（SHA）系列算法，以及国内的SM3算法。
## 性能
有计算敏感型和非敏感型。
## 数字摘要
数字摘要是hash算法的重要用途之一。
定义：对原始数字内容进行hash运算，获取唯一的摘要值。
利用hash函数抗碰撞性特点，数字摘要可以检测内容是否被篡改过。
## Hash攻击与防护
Hash算法并不是一种加密算法，不能用于对信息的保护。

但hash算法可用于对登陆口令的保存上。对密码进行hash计算后保存到数据库中。
为了更进一步的加强，可以采用加盐Salt的方法。保存的不是原文的直接hash，而是原文再加上一段随机字符串（即“盐”）之后的hash值。Hash结果和“盐”分别存放在不同的地方。

---
# 加解密算法
从设计理念和应用场景上可以分为两大基本类型：对成加密、非对称加密。

|算法类型|特点|优势|缺陷|代表算法|
|:-|:-|:-|:-|:-|
|对称加密|加解密的秘钥相同|计算效率高，加密强度高|需提前共享秘钥，易泄露|DES、3DES、AES、IDEA|
|非对称加密|加解密的秘钥不相同|无需提前共享秘钥|计算效率低，存在中间人攻击可能|RAS、EIGamal、椭圆曲线算法|

# 加解密系统基本组成

现代加解密系统的典型组件包括算法和秘钥，秘钥包括加密秘钥和解密秘钥。
加解密算法自身是固定不变的，并且一般公开可见；秘钥则是最关键的信息，需要安全地保存起来，甚至通过特殊硬件进行保护。一般来说，秘钥需要在加密前按照特定算法随机生成，长度越大，则加密强度越大。
示意图：
![加解密示意](../img/加解密示意.png)

## 对称加密算法
加密和解密的秘钥是相同的。
优点：加解密效率（速度快，空间占用小）和加密强度都很高。
缺点：参与方需提前持有秘钥，一旦有人泄露则系统安全性被破坏；另外如何在不安全通道中提前分发秘钥也是个问题，需要借助额外的Diffie-Hellman协商协议或非对称加密算法来实现。

对称密码从实现原理上可以分为两种：分组加密和序列加密。前者将明文切分为定长数据块作为基本加密单位，应用最为广泛。后者则每次只对一个字节或字符进行加密处理，且密码不断变化，只用在一些特定领域（如数字媒介的加密）。
**分组加密**的代表算法包括DES、3DES、AES、IDEA等
**序列加密**又称流加密。
> 总结： 对称加密算法适用于大量数据的加解密过程，不能用于签名场景，并且需要提前安全地分发秘钥。

## 非对称加密算法
加密秘钥：公钥-->可以根据私钥生成；公开，他人可获取
解密秘钥：私钥--> 随机数算法生成；保密，
适用于：签名场景或秘钥协商过程，但不适合大量数据的加解密。

## 混合加密机制
该机制同时结合了对称加密和非对称加密的有点。
主要过程为：先用非对称加密（计算复杂度较高）协商出一个临时的对称加密秘钥（或称会话秘钥），然后双方再通过对称加密算法（计算复杂度低）对所传递的大量数据进行快速的加密处理。
典型案例：HTTPS；与以明文方式传输数据的HTTP协议不同，HTTPS在传统的HTTP层和TCP层之间引入了Transport Layer Security/Secure Socket Layer（TLS/SSL）加密层来实现安全传输。

---
# 消息认证码与数字签名
消息认证码和数字签名技术通过对消息的摘要进行加密，可以防止消息被篡改和认证身份。

## 消息认证码
消息认证码（Hash-based Message Authentication Code， HMAC），利用对称加密，对消息完整性（integrity）进行保护。
基本过程为对某个消息，利用提前共享的对称秘钥和hash算法进行处理，得到HMAC值。该HMAC值持有方可以向对方证明自己拥有某个对称秘钥，并且确保所传输消息内容未被篡改。
## 数字签名
类似在纸质合同上进行签名以确认合同内容和证明身份。数字签名既可以证实某数字内容的完整性，又可以确认其来源（即不可抵赖，Non-Repudiation）。

